% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/formr_wrapper.R
\name{bwd_assign_next}
\alias{bwd_assign_next}
\title{Stateless BWD Assignment with Automated History Parsing}
\usage{
bwd_assign_next(
  current_covariates,
  history = NULL,
  bwd_settings,
  history_covariate_cols = NULL,
  checkpoint_interval = 20
)
}
\arguments{
\item{current_covariates}{Numeric vector. The covariates for the current participant.}

\item{history}{The history object. Can be:
\itemize{
  \item A \code{data.frame} (result of \code{formr_api_results}).
  \item A \code{list} of pre-parsed history entries.
}}

\item{bwd_settings}{List. Configuration for the balancer (e.g. \code{list(N=1000, D=5)}).}

\item{history_covariate_cols}{Character vector. Required if \code{history} is a data.frame.
Specifies the column names in the dataframe that correspond to \code{current_covariates},
in the exact same order.}

\item{checkpoint_interval}{Integer. How often to save the full state (default 20).
Interim entries will store NULL state to save bandwidth.}
}
\value{
A list containing:
  \itemize{
    \item \code{assignment}: Integer (0 or 1).
    \item \code{json_result}: String. The optimized JSON to save to the database.
    \item \code{timestamp}: Numeric.
  }
}
\description{
Handles the full lifecycle of a BWD assignment in a stateless environment (like formr).
It parses raw history data, replays events to synchronize state, assigns the next treatment,
and formats the output for efficient storage (checkpointing).
}
