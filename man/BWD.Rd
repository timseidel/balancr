% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bwd.R
\name{BWD}
\alias{BWD}
\title{Balancing Walk Design with Restarts}
\description{
The Balancing Walk Design with Restarts. At each step, it adjusts randomization
probabilities to ensure that imbalance tends towards zero.
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{q}}{Target marginal probability of treatment.}

\item{\code{intercept}}{Whether to add an intercept term.}

\item{\code{delta}}{Probability of failure.}

\item{\code{N}}{Total number of points.}

\item{\code{D}}{Dimension of the data.}

\item{\code{value_plus}}{Value added to imbalance when treatment is 1.}

\item{\code{value_minus}}{Value added to imbalance when treatment is 0.}

\item{\code{phi}}{Robustness parameter.}

\item{\code{alpha}}{Normalizing constant (threshold).}

\item{\code{w_i}}{Current imbalance vector.}

\item{\code{iterations}}{Current iteration count.}
}
\if{html}{\out{</div>}}
}
\section{Active bindings}{
\if{html}{\out{<div class="r6-active-bindings">}}
\describe{
\item{\code{definition}}{Dictionary of definition parameters.}

\item{\code{state}}{Dictionary of current state.}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-BWD-new}{\code{BWD$new()}}
\item \href{#method-BWD-set_alpha}{\code{BWD$set_alpha()}}
\item \href{#method-BWD-process_x}{\code{BWD$process_x()}}
\item \href{#method-BWD-update_imbalance}{\code{BWD$update_imbalance()}}
\item \href{#method-BWD-assign_next}{\code{BWD$assign_next()}}
\item \href{#method-BWD-replay_assignment}{\code{BWD$replay_assignment()}}
\item \href{#method-BWD-assign_all}{\code{BWD$assign_all()}}
\item \href{#method-BWD-update_state}{\code{BWD$update_state()}}
\item \href{#method-BWD-reset}{\code{BWD$reset()}}
\item \href{#method-BWD-clone}{\code{BWD$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-new"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-new}{}}}
\subsection{Method \code{new()}}{
Initialize the BWD balancer.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$new(N, D, delta = 0.05, q = 0.5, intercept = TRUE, phi = 1)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{N}}{Total number of points.}

\item{\code{D}}{Dimension of the data.}

\item{\code{delta}}{Probability of failure (default 0.05).}

\item{\code{q}}{Target marginal probability of treatment (default 0.5).}

\item{\code{intercept}}{Whether to add an intercept term (default TRUE).}

\item{\code{phi}}{Robustness parameter (default 1).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-set_alpha"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-set_alpha}{}}}
\subsection{Method \code{set_alpha()}}{
Set normalizing constant for remaining N units.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$set_alpha(N)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{N}}{Number of units remaining.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-process_x"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-process_x}{}}}
\subsection{Method \code{process_x()}}{
Internal helper to process the input vector x.
Returns the vector with intercept if applicable.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$process_x(x)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{x}}{Covariate profile vector.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-update_imbalance"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-update_imbalance}{}}}
\subsection{Method \code{update_imbalance()}}{
Manually update internal state based on an assignment.
Used during Replay/Event Sourcing.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$update_imbalance(x_proc, assignment)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{x_proc}}{Processed covariate vector (with intercept).}

\item{\code{assignment}}{The treatment assignment (0 or 1).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-assign_next"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-assign_next}{}}}
\subsection{Method \code{assign_next()}}{
Assign treatment to the next point.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$assign_next(x)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{x}}{Covariate profile vector.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Treatment assignment (0 or 1).
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-replay_assignment"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-replay_assignment}{}}}
\subsection{Method \code{replay_assignment()}}{
Replay a historical assignment, respecting Restart logic.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$replay_assignment(x, assignment)}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-assign_all"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-assign_all}{}}}
\subsection{Method \code{assign_all()}}{
Assign all points in a matrix (offline setting).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$assign_all(X)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{X}}{Matrix of covariate profiles (N x D).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Vector of treatment assignments.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-update_state"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-update_state}{}}}
\subsection{Method \code{update_state()}}{
Update the internal state of the balancer.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$update_state(w_i, iterations, alpha = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{w_i}}{Current imbalance vector.}

\item{\code{iterations}}{Current iteration count.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-reset"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-reset}{}}}
\subsection{Method \code{reset()}}{
Reset the balancer to initial state.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$reset()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BWD-clone"></a>}}
\if{latex}{\out{\hypertarget{method-BWD-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BWD$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
